# Advanced SQL Queries.
ðŸ‘‹ Hi, this folder contains Solution for Advanced SQL business questions



## Q.1 Write Query to get the Customer with the highest total order value for each year-month?

Result should include the columns year, month, customerid, total_monhtly_order_value.
Output should be ordered by year and month in ascending order.
Note: In case there are 2 customer with quale highest total order value, return the one with a Lower Customerid.

### 2 tables. Orders and Orders_details
![image](https://user-images.githubusercontent.com/50954720/213547288-f69a314d-7c03-4875-a416-2d54f180eca8.png) ![image](https://user-images.githubusercontent.com/50954720/213547583-222b0d2b-5c82-4903-91ba-db41dd4917b7.png)

### sample data

![image](https://user-images.githubusercontent.com/50954720/213548338-6ea30e69-1622-4543-9869-d807754964b2.png)

### ANSWER
![image](https://user-images.githubusercontent.com/50954720/213549948-6d890dc9-0cb0-48ae-b0e2-8b8d16d124c2.png)


## Q.2 Write query to get median for each month-year?
Traffic on a Website was recorded on multiple days over 2 years, 2017-2018. Create a Query that, for each month, will return a row with the month number,meadian for that month in 2017, in 2018. Order the result by month. 

### traffic table
![image](https://user-images.githubusercontent.com/50954720/213551519-916cdb05-658e-4502-8d04-f51e99eb3c9b.png)

### sample table
![image](https://user-images.githubusercontent.com/50954720/213551717-190ba05f-b6b1-4516-b27b-54160ed39aca.png)

step1. ![image](https://user-images.githubusercontent.com/50954720/213552270-f7b6d6f5-796a-4dbc-94e6-eea43ccbe31c.png)

### Result
![image](https://user-images.githubusercontent.com/50954720/213552658-29b424fe-55a2-4f69-bf42-3f21be3c2e93.png)


___ end of case study
